<html>
    <head>
		<meta http-equiv="content-type" content="text/html; charset=iso-8859-2">
        <title>Dokumentace: Freetag</title>
        <style>
        	pre {
				display: block;
				padding: 5px;
				border: solid 1px #333333;
				background-color: #cccccc;
			}
        </style>
    </head>

<body>
    
<h1>Dokumentace k pluginu 'Freetag'</h1>

<p>Dokumentaci k tomuto pluginu pøelo¾il do èe¹tiny Vladimír Ajgl (vlada [zavinac] ajgl [tecka] cz) dne 22.8.2011. Od té doby mohl být plugin pozmìnìn nebo mohly být roz¹íøené jeho funkce. Zkontrolujte pro jistotu i <a href="README">aktuální anglické "README"</a>, <a href="README.txt">"README.txt"</a> a <a href="ChangeLog">ChangeLog</a>.
<p>

<p>Následující kód ukazuje pøíklad, jak pou¾ít roz¹íøený výstup do smarty ¹ablony. Takto mù¾e napøíklad vypadat ¹ablona "entries.tpl"
<pre>
{if isset($entry.freetag.extended) && $entry.freetag.extended == 1}
	{if $entry.freetag.tags.tags}
		&lt;div class="serendipity_freeTag"&gt;{$entry.freetag.tags.description}
			{foreach from=$entry.freetag.tags.tags item="tag"}
				{$tag}
			{/foreach}
		&lt;/div&gt;
	
		{if $is_single_entry or $is_preview}
			{$entry.freetag.related.description}
			&lt;ul class="serendipity_freeTag_related"&gt;
			{foreach from=$entry.freetag.related.entries item="link"}
				&lt;li&gt;{$link}&lt;/li&gt;
			{/foreach}
			&lt;/ul&gt;
		{/if}
	{/if}
{else}
	{$entry.freetag}
{/if}
</pre>
</p>

<p>
Pomocí následujícího sql dotazu mù¾ete v databázi vytvoøit tagy z existujících kategorií:
<pre>
INSERT INTO serendipity_entrytags (entryid, tag) 
  SELECT serendipity_entries.id, serendipity_category.category_name 
    FROM serendipity_entries, serendipity_category, serendipity_entrycat 
   WHERE serendipity_entrycat.entryid = serendipity_entries.id 
     AND serendipity_category.categoryid = serendipity_entrycat.categoryid;
</pre>
(pøevzato z <a href="http://pixelated-dreams.com/archives/229-Spring-Cleaning.html">http://pixelated-dreams.com/archives/229-Spring-Cleaning.html</a>)
</p>
<p>
A nebo mù¾ete pro vytvoøení tagù z kategorií pou¾ít následující skript:
<pre>
&lt;?php
include 'serendipity_config.inc.php';

$rows = serendipity_db_query("SELECT e.id, e.title, c.category_name
                                FROM {$serendipity['dbPrefix']}entries AS e
                                JOIN {$serendipity['dbPrefix']}entrycat AS ec
                                  ON ec.entryid = e.id
                                JOIN {$serendipity['dbPrefix']}category AS c
                                  ON ec.categoryid = c.categoryid");

foreach($rows AS $row) {
    serendipity_db_query(
        sprintf(
            "REPLACE INTO {$serendipity['dbPrefix']}entrytags (entryid, tag) VALUES (%d, %s)",
            (int)$row['id'],
            serendipity_db_escape_string($row['category_name'])
        )
    );
    
    printf(
        "Category '%s' added as Tag for Entry #%d, '%s'&lt;br /&gt;\n",
        htmlspecialchars($row['category_name']),
        (int)$row['id'],
        htmlspecialchars($row['title'])
    );
}
?&gt;

</pre>
</p>

<h1>Historie verzí (ChangeLog)</h1>
<ul>
<li>verze 3.35</li>
	<ul>
	<li>Opraveno - Zmìna nìkterých instancí [tag] na %5Btag%5D, který je kompatibilní s HTML - bug è.3427291</li>
	</ul>
<li>verze 3.34</li>
	<ul>
	<li>Pro mysql pou¾ít pouze sql dotaz SHOW.</li>
	</ul>
<li>verze 3.33</li>
	<ul>
	<li>Odkazy na https:// místo http://, aby správnì fungoval backend na serverech se zapnutým SSL. Díky u¾ivateli [Manko10].</li>
	</ul>
<li>verze 3.30, 3.31, 3.32</li>
	<ul>
	<li>Aktualizováno - pou¾itý pøilo¾ený tagcloud.swf od WP-Cumulus/Roy Tanck na verzi 1.23.</li>
	<li>Opraveno - Hrozba HTML injection nahlá¹ená u¾ivatelem [MustLive]</li>
	<li>Opraveno - Hrozba XSS (Cross Site Scripting) nahlá¹ená u¾ivatelem [Stefan Schurtz]</li>
	</ul>
<li>verze 3.28</li>
	<ul>
	<li>Mo¾nost pou¾ití konstrukce ?serendipity[tag]=Tag1;Tag2;Tag3</li>
	</ul>
<li>verze 3.27</li>
	<ul>
	<li>Správná detekce porovnání (collation) v MySQL databázi</li>
	</ul>
<li>verze 3.26</li>
	<ul>
	<li>Pøidána kontrola is_array() [Timbalu]</li>
	</ul>
<li>verze 3.25</li>
	<ul>
	<li>Oprava kódování databáze</li>
	</ul>
<li>verze 3.24</li>
	<ul>
	<li>Pøidáno kórování databáze (MySQL), oprava od u¾ivatele [Vincent]</li>
	</ul>
<li>verze 3.23</li>
	<ul>
	<li>Pøidána oprava zalamování bílých znakù, viz <a href="http://board.s9y.org/viewtopic.php?f=5&t=17760">http://board.s9y.org/viewtopic.php?f=5&t=17760</a></li>
	</ul>
<li>verze 3.22</li>
	<ul>
	<li>O¹etøen mo¾ný XSS útok (Cross Site Scripting) reportovaný u¾ivatelem [Stefan Schurtz] (SSCHADV2011-004)</li>
	</ul>
<li>verze 3.21</li>
	<ul>
	<li>Pøidán háèek (event hook) "sort" pro plugin serendipity_event_sort (autor [lazybadger])</li>
	</ul>
<li>verze 3.20</li>
	<ul>
	<li>Mrak tagù se zobrazuje jako smarty ¹ablona "plugin_freetag.tpl". Pokud si chcete pøizpùsobit výstup, zkopírujte tento soubor do adresáøe va¹eho stylu vzhledu a upravte ho dle sebe.</li>
	</ul>
<li>verze 3.18</li>
	<ul>
	<li>Automatická detekce klíèových slov nyní funguje pouze vnì html tagù, tak¾e nic jako &lt;a href="/serendipity/"&gt; nyní nebude detekováno jako klíèové slovo 'serendipity'</li>
	</ul>
<li>verze 3.17</li>
	<ul>
	<li>Pøidána funkce do administrátorské sekce: vyèi¹tìní tagù pøiøazených k neexistujícím pøíspìvkùm.</li>
	<li>Text potvrzovacího tlaèítko ve formuláøi pro pøejmenování tagu u¾ není zadán natvrdo, ale dá se pøelo¾it.</li>
	<li>Opravena chyba v syntaxi HTML ve formuláøi pro pøejmenování tagu, a to pou¾itím odpovídající HTML entity.</li>
	</ul>
<li>verze 3.16</li>
	<ul>
	<li>Oprava chyby: Klíèová slova (meta-keywords) se nezobrazovala v pøíspìvcích.</li>
	</ul>
<li>verze 3.15</li>
	<ul>
	<li>Odstranìna nesprávná chybová hlá¹ka "FATAL ERROR! Unrecognized type for 
serendipity_event_freetag:: !" 
	<br />(Fatální chyba! Neznámý typ pro serendipity_event_freetag:: !)</li>
	</ul>
<li>verze 3.13, 3.14</li>
	<ul>
	<li>Pøidáno volání funkce mb_internal_encoding() pro správný pøevod znakù na malá písmena.</li>
	</ul>
<li>verze 3.12.1</li>
	<ul>
	<li>Nahrazeno "wick-based" automatické doplòování jquery pluginem (wick nefungoval v Opeøe) </li>
	</ul>
<li>verze 3.11.0</li>
	<ul>
	<li>Pøidána volba, zda mají být tagy pøidány na základì automatického hledání klíèových slov.</li>
	<li>Opraveny fale¹né výsledky pøi zmìnì hledání na regulární výrazy.</li>
	</ul>
<li>verze 3.10.5</li>
	<ul>
	<li>Chytání oèekávaných chyb v tagcloud query.</li>
	</ul>
<li>verze 3.10.4</li>
	<ul>
	<li>Pøidána dal¹í kontrola na prázdný výsledek pro potlaèení chybových hlá¹ek databáze.</li>
	</ul>
<li>verze 3.10.3</li>
	<ul>
	<li>Opraveny chybìjící tagy v náhledu ulo¾eného pøíspìvku v pøehledu pøíspìvkù.</li>
	<li>Opraveno pøipojování výstupu k náhledu v editoru.</li>
	</ul>
<li>verze 3.10.2</li>
	<ul>
	<li>Opravena chybná detekce roz¹íøeného/jednoduchého pøíspìvku.</li>
	</ul>
<li>verze 3.10</li>
	<ul>
	<li>Produkuje podobné èlánky jako neèíslovaný seznam &lt;ul&gt;</li>
	<li>Zanoøení o jeden krok ní¾e pøi prohledávání podobných tagù.</li>
	<li>"Podobné tagy" je nyní odstavec &lt;p&gt; míst pùvodního bloku &lt;div&gt;</li>
	<li>Zaveden roz¹íøený Smarty-Markup</li>
	<li>Vyèi¹tìní kódu v displayEntry()</li>
	</ul>
<li>verze 3.09</li>
	<ul>
	<li>Opraveno chybìjící escapování promìnných v SQL dotazech.</li>
	</ul>
<li>verze 3.08 [Chessnut]</li>
	<ul>
	<li>Pøi prohlí¾ení pøíspìvkù podle tagù nejsou pou¾ívána omezení kategoriemi (jako napøíklad v pluginu startcat)</li>
	</ul>
<li>verze 3.07</li>
	<ul>
	<li>Kontrola, ¾e se pole array vytvoøí pouze pøi úspì¹ném provedení SQL dotazu.</li>
	</ul>
<li>verze 3.06 [garvinhicking]</li>
	<ul>
	<li>Oprava automatického hledání dle klíèových slov i na tagy s velkými písmeny.</li>
	</ul>
<li>verze 3.05 [garvinhicking]</li>
	<ul>
	<li>Pou¾ívání pouze flash-bg/fg barev, pokud je flash cloud zapnut.</li>
	</ul>
<li>verze 3.04 [garvinhicking]</li>
	<ul>
	<li>Pøidána nezdokumentovaná volba pro vlo¾ení pøíbuzných pøíspìvkù do pøehledu (<a href="http://board.s9y.org/viewtopic.php?f=10&t=11124&p=83814#p83814">http://board.s9y.org/viewtopic.php?f=10&t=11124&p=83814#p83814</a>)</li>
	</ul>
<li>verze 3.03 [garvinhicking]</li>
	<ul>
	<li>Pøidáno escapování databáze pøi ètení tagù.</li>
	<li>Opraven duplicitní øetìzec LIMIT v SQl dotazu. (Díky u¾ivateli [rupa])</li>
	</ul>
<li>verze 3.01 [designor]</li>
	<ul>
	<li>Optimalizace výstupu, pou¾ití nejnovìj¹ího SWFObject.</li>
	</ul>
<li>verze 3.0 [lstrojny]</li>
	<ul>
	<li>Oprava verze</li>
	</ul>
<li>verze 2.51 [lstrojny]</li>
	<ul>
	<li>Opraveno øazení tagù pøi pou¾ití se ¹ablonou.</li>
	</ul>
<li>verze 2.5 [lstrojny]</li>
	<ul>
	<li>Pøidání mo¾nosti pou¾ití Smarty ¹ablony pro vykreslení postranního sloupce.</li>
	<li>Sjednocení èísel verzí.</li>
	</ul>
<li>verze 2.105 [RobA]</li>
	<ul>
	<li>Opravy ve Flashi, omezování poètu tagù, výchozí hodnoty nastavení.</li>
	</ul>
<li>verze 2.103 [RobA]</li>
	<ul>
	<li>Pøidán rotující Flashový tagcloud (mrak tagù)</li>
	</ul>
<li>verze 2.97 [garvinhicking]</li>
	<ul>
	<li>Mo¾nost umístìní tagù do smarty ¹ablony pomocí {$entry.freetag}, pokud je nastaveno pou¾ití smarty.</li>
	</ul>
<li>verze 2.96 [garvinhicking]</li>
	<ul>
	<li>Oprava XSS pøi zobrazování mraku pøíbuzných tagù, díky [<a href="mailto:Alex@bitsploit.de">Alex@bitsploit.de</a>]</li>
	</ul>
<li>verze 2.95 [garvinhicking]</li>
	<ul>
	<li>Pøidán nastavitelný obrázek technorati</li>
	</ul>
<li>verze 2.92/2.45 [brockhaus]</li>
	<ul>
	<li>Pøidáno nastavení pro XML obrázek</li>
	</ul>
<li>verze 2.88/2.44 [brockhaus]</li>
	<ul>
	<li>Pøidán volitelný tag technorati za tagy v patièce pøíspìvku.</li>
	</ul>
<li>verze 2.88/2.43 [brockhaus]</li>
	<ul>
	<li>Pøidána mo¾nost nastavení minimální/maximální velikosti fontu v postranním sloupci.</li>
	</ul>
<li>verze 2.88/2.42 [garvinhicking]</li>
	<ul>
	<li>Øazení tagù v postranním sloupci bez ohledu na velikost písmen.</li>
	</ul>
<li>verze 2.88/2.41 [brockhaus]</li>
	<ul>
	<li>Plugin pro postranní sloupec v¾dycky naèetl prvních X tagù podle jména, ne podle pøíbuznosti (tagcount, poèet tagù). Tedy pøíbuzné/podobné tagy tagy na konci abecedy se nezobrazovaly.</li>
	</ul>
<li>verze 2.70</li>
	<ul>
	<li>Pøidána mo¾nost "automatické tagy". To znamená, které tagy pøiøadit k pøíspìvku, pokud jsou v nìm nalezena klíèová slova svázaná s tagem.</li>
	</ul>
<li>verze 2.64</li>
	<ul>
	<li>Pøidána volba pro pøevod kategorií na tagy.</li>
	</ul>
<li>verze 2.48</li>
	<ul>
	<li>Nastavení pro pøevod na mlá písmena, oprava od [Lars Strojny]</li>
	</ul>
<li>verze 2.47</li>
	<ul>
	<li>Lep¹í zobrazování meta-informací</li>
	</ul>
<li>verze 2.44</li>
	<ul>
	<li>Zobrazování podobných pøíspìvkù, oprava od [Stain]</li>
	<li>Zmìna místa zobrazování tagù, nyní nastavitelné u¾ivatelem.</li>
	</ul>

</ul>

  </body>
</html>
